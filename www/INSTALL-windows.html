<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="Docutils 0.4: http://docutils.sourceforge.net/" />
<title>Windows Compilation</title>
<style type="text/css">

/* magick.css -- default style sheet */

BODY, P, TD, TH, UL, OL  {
	font-family : Verdana, Arial, Helvetica, sans-serif;
	font-size : medium;
}

H1, H2, H3, H4  {
	font-family : Verdana, Arial, Helvetica, sans-serif;
}

H1  {
	font-size : 120%;
}

H2  {
	font-size : 110%;
}

H3, H4  {
	font-size : 105%;
}

A:LINK  {
	text-decoration : underline;
	color : #0085C0;
}

A:VISITED  {
	text-decoration : underline;
	color : Purple;
}

A:HOVER  {
	text-decoration : underline;
	color : #0085C0;
}

A.nav:LINK  {
	text-decoration : none;
	color : #0085C0;
}

A.nav:VISITED  {
	text-decoration : none;
	color : Purple;
}

A.nav:HOVER  {
	text-decoration : underline;
	color : #0085C0;
}

A.leftcolnav:LINK  {
	text-decoration : none;
	color : #0085C0;
}

A.leftcolnav:HOVER  {
	text-decoration : none;
	background : #999999;
	color: black;
}

A.leftcolnav:VISITED  {
	text-decoration : none;
	color : Purple;
}

.stripes  {
	font-size : smaller;
}

.navtopon  {
	background-color : #999999;
	font-size : smaller;
	text-align : center;
	font-weight : bold;
}

.navtopoff  {
	font-size : smaller;
	text-align : center;
	font-weight : bold;
}

.gutter  {
	margin-top : 2mm;
	margin-right : 3mm;
	margin-bottom : 3mm;
	margin-left : 5mm;
}

.bannergutter {
        margin-top : 2mm;
        margin-right : 3mm;
}

.pagebodygutter  {
	margin-top : 2mm;
}

.pagecentergutter  {
        margin-left : 20mm;
        margin-right: 20mm;
        margin-top : 5mm;
        margin-bottom: 2mm;
}

.leftcolgutter  {
	margin-top : 2mm;
	margin-right : 1mm;
	margin-left : 3mm;
}

.textcolgutter  {
	margin-bottom : 1.5mm;
}

.textpromo  {
	font-size : medium;
	margin-top : 2mm;
	margin-right : 1mm;
	margin-left : 2mm;
}

.newscolgutter  {
	margin-left : 1mm;
	margin-top : 2mm;
	margin-bottom : 3mm;
	font-size : medium;
}

.itemgutter  {
	margin-left : 1.5mm;
	font-size : small;
}

.logogutter  {
	margin-top : 3mm;
	margin-bottom : 2mm;
	margin-left : 3mm;
}

.navtext  {
	font-size : smaller;
}

.navlevel2 {
        font-size : 9pt;
}

.navlevel3 {
        font-size : 8pt;
}

.navlevel2on {
        font-size : 9pt;
	background-color : #cccccc;
}

.navlevel3on {
        font-size : 8pt;
        background-color : #cccccc;
}

.navlevel1on {
	background-color : #cccccc;
}

.note  {
	font-style : italic;
	color : gray;
}

.textwhite  {
	color : white;
}

.small  {
	font-size : smaller;
}

.tiny  {
	font-size : smaller;
}

.confirmation  {
	color : Lime;
}

.warning  {
	color : #ffcc66;
}

.error  {
	color : Red;
}

.disclaimer  {
	font-size : smaller;
	color : Gray;
	margin-top : 1em;
	margin-bottom : 1em;
}


.bgwhite {
        background-color: White;
}

.1colgutter {
        margin-top: 2mm;
        margin-right: 3mm;
        margin-left: 3mm;
}

.1colnavgutter {
        margin-right: 1mm;
        margin-left: 1mm;
}

.largeboldfont {
	font-size : 110%;
	font-weight: bold;
}

.redfont {
	color : red;
}


</style>
</head>
<body>
<div class="document" id="windows-compilation">
<h1 class="title">Windows Compilation</h1>
<!-- This text is in reStucturedText format, so it may look a bit odd. -->
<!-- See http://docutils.sourceforge.net/rst.html for details. -->
<div class="contents local topic">
<ul class="simple">
<li><a class="reference" href="#applicability" id="id1" name="id1">Applicability</a></li>
<li><a class="reference" href="#important-notes" id="id2" name="id2">Important Notes</a></li>
<li><a class="reference" href="#windows-win2k-98-visual-c-6-0-7-x-and-8-0-compilation" id="id3" name="id3">Windows WIN2K/98 Visual C++ 6.0, 7.X, and 8.0 Compilation</a></li>
<li><a class="reference" href="#environment-variables" id="id4" name="id4">Environment Variables</a></li>
</ul>
</div>
<div class="section">
<h1><a class="toc-backref" href="#id1" id="applicability" name="applicability">Applicability</a></h1>
<blockquote>
These installation instructions are for Microsoft Windows using
the Visual C++ (Visual Studio, etc.) IDE.  For building using
the free Cygwin or MinGW compilers, follow the instructions in
INSTALL-unix.txt.</blockquote>
</div>
<div class="section">
<h1><a class="toc-backref" href="#id2" id="important-notes" name="important-notes">Important Notes</a></h1>
<blockquote>
On some platforms Visual C++ may fail with an internal compiler error.
If this happens to you, then make sure that your compiler is updated
with the latest fixes from the Microsoft web site and the problem
should go away.</blockquote>
</div>
<div class="section">
<h1><a class="toc-backref" href="#id3" id="windows-win2k-98-visual-c-6-0-7-x-and-8-0-compilation" name="windows-win2k-98-visual-c-6-0-7-x-and-8-0-compilation">Windows WIN2K/98 Visual C++ 6.0, 7.X, and 8.0 Compilation</a></h1>
<blockquote>
<p>The Visual C++ distribution targeted at Windows XP, Win2K, or Windows 98
does not provide any stock workspace (DSW) or project files (DSP) except
for those included with third party libraries. Instead, there is a
&quot;configure&quot; program that must be built and run that creates build
environments to satisfy various requirements.</p>
<p>The Visual C++ system provides three different types of &quot;runtimes&quot;
that must match across all application, library, and DLL code that is
built. The &quot;configure&quot; program creates a set of build files that are
consistent for a specific runtime selection.</p>
<p>The three options for runtime support are:</p>
<blockquote>
<ol class="arabic simple">
<li>Dynamic Multi-threaded DLL runtimes (VisualDynamicMT).</li>
<li>Static Single-threaded runtimes (VisualStaticST).</li>
<li>Static Multi-threaded runtimes (VisualStaticMT).</li>
<li>Static Multi-threaded DLL runtimes (VisualStaticMTDLL).</li>
</ol>
</blockquote>
<p>In addition to these runtimes, the VisualMagick build environment allows
you to select whether to include the X11 libraries in the build or not.
X11 DLLs and headers are provided with the VisualMagick build
environment. Most Windows users do not use X11 so they will prefer to
build without X11 support. When X11 is not supported, gm subcommands
'animate', 'display', and 'import' will not work.</p>
<p>This leads to five different possible build options, which should
cover almost any particular situation. The default binary distribution
is built using #1 from above with the X11 libraries included. This
results in an X11 compatible build using all DLL's for everything and
multi-threaded support (the only option for DLL's).</p>
<p>To do a build for your requirements, simply go to the configure sub-
directory under VisualMagick and open the configure.dsw workspace (for
Visual C++ 6.0) or configure.sln (for Visual C++ 7.X or 8.X). Set the
build configuration to &quot;Release&quot; under the</p>
<blockquote>
&quot;Build..., Set Active Configuration...&quot;  menu.</blockquote>
<p>Build and execute the configure program and follow the on-screen
instructions. You should not change any of the defaults unless you have a
specific reason to do so.</p>
<p>The configure program provides a button entitled</p>
<blockquote>
Edit &quot;magick_config.h&quot;</blockquote>
<p>Clicking this button brings up magick_config.h in Windows notepad for
optionally changing any preprocessor defines in GraphicsMagick's
magick_config.h file. This file is copied to <tt class="docutils literal"><span class="pre">magick\magick_config.h</span></tt>. You
may safely open <tt class="docutils literal"><span class="pre">magick\magick_config.h</span></tt>, modify it, and recompile without
re-running the configure program. In fact, using notepad to edit the
copied file may be preferable since it preserves the original
magick_config.h file.</p>
<p>Key user tunables in magick_config.h include:</p>
<blockquote>
<p>QuantumDepth (default 8)</p>
<blockquote>
Specify size of PixelPacket color Quantums (8, 16, or 32) A value of
8 uses half the memory than 16 and may run 30% faster, but provides
256 times less color resolution than a value of 16.</blockquote>
<p>UseInstalledMagick (default undefined)</p>
<blockquote>
Define to build a GraphicsMagick which uses registry settings or
embedded paths to locate installed components (coder modules and
configuration files). The default is to look for all files in the
same directory as the executable.</blockquote>
<p>ProvideDllMain (default undefined)</p>
<blockquote>
Define to include a DllMain() function ensures that the GraphicsMagick
DLL is properly initialized without participation from dependent
applications. This avoids the requirement to invoke IntializeMagick()
from dependent applications but only works for DLL builds.</blockquote>
</blockquote>
<p>After creating your build environment you can proceed to open the DSW (or
SLN) file that was generated in the VisualMagick directory and build
everything from there.</p>
<p>In the final DSW file you will find a project call &quot;All&quot;. In order to
build everything in the distribution, select this project and make it
the &quot;active&quot; project. Set the build configuration to the desired one
(Debug, or Release) and do a &quot;clean&quot; followed by a &quot;build&quot;. You should
do the build in a specific way:</p>
<blockquote>
<ol class="arabic simple">
<li>Make the &quot;All&quot; project the active project (Bold)
Right click on the All project and select &quot;Set As Active Project&quot;</li>
<li>Select &quot;Build..., Clean&quot;</li>
<li>Select &quot;Build..., Build&quot;</li>
<li>Go get some coffee unless you have a very fast machine!.</li>
</ol>
</blockquote>
<p>The &quot;Clean&quot; step is needed in order to make sure that all of the target
support libraries are updated with any patches needed to get them to
compile properly under Visual C++.</p>
<p>All of the required files that are needed to run any of the command
line tools will be found in the &quot;bin&quot; subdirectory of the VisualMagick
subdirectory. This includes EXE, and DLL files. You should be able
to test the build directly from this directory without having to move
anything to any of the global SYSTEM or SYSTEM32 areas in the operating
system installation.</p>
<p>Note #1:</p>
<p>The Visual C++ distribution of GraphicsMagick comes with the Magick++
C++ wrapper by default. This add-on layer has a large number of demo
and test files that can be found in <tt class="docutils literal"><span class="pre">GraphicsMagick\Magick++\demo</span></tt>, and
<tt class="docutils literal"><span class="pre">GraphicsMagick\Magick++\tests</span></tt>. There are also a variety of tests that
use the straight C API as well in <tt class="docutils literal"><span class="pre">GraphicsMagick\tests</span></tt>.</p>
<p>All of these programs are NOT configured to be built in the default
workspace created by the configure program. You can cause all of these
demos and test programs to be built by checking the box in configure
that says:</p>
<blockquote>
&quot;Include all demo and test programs&quot;</blockquote>
<p>In addition, there is another related checkbox (checked by default)
that causes all generated project files to be created standalone so
that they can be copied to other areas of you system.</p>
<p>This is the checkbox:</p>
<blockquote>
&quot;Generate all utility projects with full paths rather then relative
paths&quot;</blockquote>
<p>WOW - that a mouthfull - eh?</p>
<p>Visual C++ uses a concept of &quot;dependencies&quot; that tell it what other
components need to be build when a particular project is being build. This
mechanism is also used to ensure that components link properly. In my normal
development environment, I want to be able to make changes and debug the
system as a whole, so I like and NEED to use dependencies. However, most
end users don't want to work this way.</p>
<p>Instead they really just want to build the package and then get down
to business working on their application. The solution is to make all
the utility projects (UTIL_xxxx_yy_exe.dsp) use full absolute paths
to all the things they need. This way the projects stand on their own
and can actually be copied and used as templates to get a particular
custom application compiling with little effort.</p>
<p>With this feature enabled, you should be able to nab a copy of...</p>
<blockquote>
<p><tt class="docutils literal"><span class="pre">VisualMagick\utilities\UTIL_convert_xxx_exe.dsp</span></tt>  (for C)</p>
<blockquote>
-or-</blockquote>
<p><tt class="docutils literal"><span class="pre">VisualMagick\Magick++\demo\UTIL_demo_xxx_exe.dsp</span></tt> (for C++)</p>
</blockquote>
<p>... and pop it into notepad, modify it (carefully) to your needs and
be on your way to happy compiling and linking.</p>
<p>You can feel free to pick any of the standard utilities, tests, or
demo programs as the basis for a new program by copying the project
and the source and hacking away.</p>
<p>The choice of what to use as a starting point is very easy...</p>
<p>For straight C API command line applications use something from</p>
<blockquote>
<p><tt class="docutils literal"><span class="pre">GraphicsMagick\tests</span></tt> or <tt class="docutils literal"><span class="pre">GraphicsMagick\utilities</span></tt> (source code)</p>
<p><tt class="docutils literal"><span class="pre">GraphicsMagick\VisualMagick\tests</span></tt> or <tt class="docutils literal"><span class="pre">GraphicsMagick\Visualmagick\utilities</span></tt>
(project - DSP)</p>
</blockquote>
<p>For C++ and Magick++ command line applications use something from</p>
<blockquote>
<p><tt class="docutils literal"><span class="pre">GraphicsMagick\Magick++\tests</span></tt> or <tt class="docutils literal"><span class="pre">GraphicsMagick\Magick++\demo</span></tt> (source code)</p>
<p><tt class="docutils literal"><span class="pre">GraphicsMagick\VisualMagick\Magick++\tests</span></tt> or
<tt class="docutils literal"><span class="pre">GraphicsMagick\VisualMagick\Magick++\demo</span></tt> (project - DSP)</p>
</blockquote>
<p>For C++ and Magick++ and MFC windows applications use</p>
<blockquote>
<p><tt class="docutils literal"><span class="pre">GraphicsMagick\contrib\win32\MFC\NtMagick</span></tt> (source code)</p>
<p><tt class="docutils literal"><span class="pre">GraphicsMagick\VisualMagick\contrib\win32\MFC\NtMagick</span></tt> (project - DSP)</p>
</blockquote>
<p>Note #2:</p>
<p>The GraphicsMagick distribution is very modular. The default
configuration is there to get you rolling, but you need to make some
serious choices when you wish to change things around.</p>
<p>The default options are all targeted at having all the components in one
place (e.g. the &quot;bin&quot; directory of the VisualMagick build tree). These
components may be copied to another folder (such as to another computer).</p>
<p>The folder containing the executables and DLLs should contain the
following files:</p>
<blockquote>
<ol class="arabic simple">
<li>colors.mgk</li>
<li>delegates.mgk</li>
<li>log.mgk</li>
<li>magic.mgk</li>
<li>modules.mgk</li>
<li>type.mgk</li>
<li>type-ghostscript.mgk (if Ghostscript is used)</li>
</ol>
</blockquote>
<p>The &quot;bin&quot; folder should contains all EXE's and DLL's as well as the
very important &quot;modules.mgk&quot; file.</p>
<p>With this default setup, you can use any of the command line tools
and run scripts as normal. You can actually get by quite nicely this
way by doing something like <tt class="docutils literal"><span class="pre">pushd</span> <span class="pre">e:\xxx\yyy\bin</span></tt> in any scripts you
write to execute &quot;out of&quot; this directory.</p>
<p>By default the core of GraphicsMagick on Win32 always looks in the place
were the exe program is run from in order to find all of the files as
well as the DLL's it needs.</p>
</blockquote>
</div>
<div class="section">
<h1><a class="toc-backref" href="#id4" id="environment-variables" name="environment-variables">Environment Variables</a></h1>
<blockquote>
<p>You can use the &quot;System&quot; control panel to allow you to add and delete
what is in any of the environment variables. You can even have user
specific environment variables if you wish.</p>
<p>PATH</p>
<blockquote>
<p>This sets the default list of places were Windows looks for EXE's and
DLL's. Windows CMD shell seems to look in the &quot;current&quot; directory first
- no matter what, which may make it unnecessary to update the PATH. If
you wish to run any of utilities from another location then you must
add the path to your &quot;bin&quot; directory in. For instance, you might add:</p>
<blockquote>
<tt class="docutils literal"><span class="pre">D:\CVS\GraphicsMagick\VisualMagick\bin</span></tt></blockquote>
<p>to do this for the default build environment like I do.</p>
</blockquote>
<p>MAGICK_HOME</p>
<blockquote>
<p>If all you do is modify the PATH variable, the first problem you
will run into is that GraphicsMagick may not be able to find any of
its &quot;modules. Modules are all the IM_MOD*.DLL files you see in the
distribution. There is one of these for each and every file format
that GraphicsMagick supports. This environment variable tells the system
were to look for these DLL's. The compiled in &quot;default&quot; is &quot;execution
path&quot; - which says - look in the same place that the application is
running &quot;in&quot;. If you are running from somewhere other then &quot;bin&quot; -
this will no longer work and you must use this variable. If you elect
to leave the modules in the same place as the EXE's (a good idea)
then you can simply set this to the same place
as you did the PATH variable. In my case:</p>
<blockquote>
<tt class="docutils literal"><span class="pre">D:\\GraphicsMagick\coders</span></tt></blockquote>
<p>This is also the place were GraphicsMagick expects to find the
&quot;colors.mgk&quot;, &quot;delegates.mgk&quot;, &quot;magic.mgk&quot;, &quot;modules.mgk&quot;, and
&quot;type.mgk&quot; files.</p>
<p>One cool thing about the modules build of GraphicsMagick is that you can
now leave out file formats and lighten you load. If all you ever need
is GIF and JPEG, then simply drop all the other DLL's into the local
trash can and get on with your life.</p>
<p>WARNING: Always keep the &quot;xc&quot; format, since IM uses it for internal
purposes.</p>
</blockquote>
<p>ALSO. You can elect to changes these things the good old &quot;hard-coded&quot;
way. Two #defines are applicable.</p>
<p>defines.h has</p>
<blockquote>
<tt class="docutils literal"><span class="pre">#define</span> <span class="pre">MagickConfigurePath</span>&nbsp; <span class="pre">&quot;c:\\GraphicsMagick\\&quot;</span></tt></blockquote>
<p>To view any image in a Microsoft window, type</p>
<blockquote>
<tt class="docutils literal"><span class="pre">convert</span> <span class="pre">image.ext</span> <span class="pre">win:</span></tt></blockquote>
<p>Make sure Ghostscript is installed, otherwise, you will be unable to
convert or view a Postscript document, and Postscript standard fonts will
not be available.</p>
<p>You may use any standard web browser (e.g. Internet Explorer) to browse
the GraphicsMagick documentation.</p>
<p>The Win2K executables will work under Windows '98 and later.</p>
</blockquote>
<hr class="docutils" />
<div class="line-block">
<div class="line">Copyright (C) 2003 - 2008 GraphicsMagick Group</div>
<div class="line">Copyright (C) 2002 ImageMagick Studio</div>
</div>
<p>This program is covered by multiple licenses, which are described in
Copyright.txt. You should have received a copy of Copyright.txt with this
package; otherwise see <a class="reference" href="http://www.graphicsmagick.org/www/Copyright.html">http://www.graphicsmagick.org/www/Copyright.html</a>.</p>
</div>
</div>
<div class="footer">
<hr class="footer" />
Generated on: 2008-03-09 23:28 UTC.

</div>
</body>
</html>
